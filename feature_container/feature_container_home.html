<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Feature Container &mdash; navigate 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Contributing Guidelines" href="../contributing/contributing_guidelines.html" />
    <link rel="prev" title="Adding New Hardware" href="../hardware/contributing_hardware.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            navigate
              <img src="../_static/mic.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../software_installation.html">Software Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software_configuration.html">Configuration Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../case_studies/case_studies_home.html">Case Studies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hardware/hardware_home.html">Hardware</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Feature Container</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#currently-implemented-features">Currently Implemented Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-feature-object">The Feature Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-custom-feature-object">Creating Custom Feature Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-custom-feature-list">Creating A Custom Feature List</a></li>
<li class="toctree-l2"><a class="reference internal" href="#combining-features">Combining Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="#loading-custom-functions">Loading Custom Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#editing-function-parameters">Editing Function Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deleting-features">Deleting Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/contributing_guidelines.html">Contributing Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">navigate</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Feature Container</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/feature_container/feature_container_home.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="feature-container">
<span id="features"></span><h1>Feature Container<a class="headerlink" href="#feature-container" title="Permalink to this heading"></a></h1>
<p>To make Navigate as powerful as possible, we want to encourage users to contribute code and
engage in the software collaboratively.</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h2>
<p>The Navigate <strong>feature container</strong> allows for reconfigurable acquisition and
analysis. The feature container runs a tree of <strong>features</strong>, where each
feature may perform a <em>signal</em> operation, where it modifies the state of
microscope hardware, a <em>data</em> operation, where it performs an analysis on
acquired image data, or both.</p>
<p>Once a feature is executed, any features dependent on this feature’s execution
will execute (for example, move the stage, then snap a picture). Following
this, the next set of features in sequence will be executed.</p>
<p>Examples of some existing features include
<code class="docutils literal notranslate"><span class="pre">navigate.model.features.common_features.ZStackAcquisition</span></code>, which acquires a
z-stack, and <code class="docutils literal notranslate"><span class="pre">navigate.model.features.autofocus.Autofocus</span></code>, which finds the
ideal plane of focus of a sample using a Discrete Cosine Transform.</p>
</section>
<section id="currently-implemented-features">
<h2>Currently Implemented Features<a class="headerlink" href="#currently-implemented-features" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>VolumeSearch</p></li>
<li><p>IlastikSegmentation</p></li>
<li><p>DetectTissueInStack</p></li>
<li><p>DetectTissueInStackAndRecord</p></li>
<li><p>RemoveEmptyPositions</p></li>
<li><p>ImageWriter</p></li>
<li><p>ConstantVelocityAcquisition</p></li>
<li><p>ChangeResolution</p></li>
<li><p>ConProAcquisition</p></li>
<li><p>FindTissueSimple2D</p></li>
<li><p>LoopByCount</p></li>
<li><p>MoveToNextPositionInMultipositionTable</p></li>
<li><p>PrepareNextChannel</p></li>
<li><p>Snap</p></li>
<li><p>StackPause</p></li>
<li><p>WaitToContinue</p></li>
<li><p>ZStackAcquisition</p></li>
</ul>
</section>
<section id="the-feature-object">
<h2>The Feature Object<a class="headerlink" href="#the-feature-object" title="Permalink to this heading"></a></h2>
<p>Each feature is an object that accepts a pointer to <code class="docutils literal notranslate"><span class="pre">navigate.model.model</span></code> in its
<code class="docutils literal notranslate"><span class="pre">__init__()</span></code>  arguments and contains a configuration dictionary that dictates
feature behavior in its <code class="docutils literal notranslate"><span class="pre">__init__()</span></code> function. A complete configuration
dictionary is shown below. As few or as many of these options can be specified
as needed.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">config_table</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;signal&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;init&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre_func_signal</span><span class="p">,</span>
                                <span class="s1">&#39;main&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_func_signal</span><span class="p">,</span>
                                <span class="s1">&#39;end&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_func_signal</span><span class="p">,</span>
                                <span class="s1">&#39;cleanup&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleanup_func_signal</span><span class="p">},</span>
                         <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;init&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre_func_data</span><span class="p">,</span>
                                  <span class="s1">&#39;main&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_func_data</span><span class="p">,</span>
                                  <span class="s1">&#39;end&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_func_data</span><span class="p">,</span>
                                  <span class="s1">&#39;cleanup&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleanup_func_data</span><span class="p">},</span>
                         <span class="s1">&#39;node&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;node_type&#39;</span><span class="p">:</span> <span class="s1">&#39;multi-step&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;device_related&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                  <span class="s1">&#39;need_response&#39;</span><span class="p">:</span> <span class="kc">True</span> <span class="p">},</span>
                        <span class="p">}</span>
</pre></div>
</div>
<p>Both <code class="docutils literal notranslate"><span class="pre">signal</span></code> and <code class="docutils literal notranslate"><span class="pre">data</span></code> configuration entries are themselves
dictionaries that can contain <code class="docutils literal notranslate"><span class="pre">init</span></code>, <code class="docutils literal notranslate"><span class="pre">main</span></code>, <code class="docutils literal notranslate"><span class="pre">end</span></code> and/or
<code class="docutils literal notranslate"><span class="pre">cleanup</span></code> entries.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">init</span></code> entries dictate pre-processing steps that must be run before the
main function of the feature starts.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">main</span></code> entries dictate the primary operation of the feature, to be once per
acqusition step</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">end</span></code> entries describe any closing operations that must be performed when
exiting the node</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cleanup</span></code> entries dictate what happens if the node fails. This is for
failsafe controls such as “turn off all lasers”</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">node</span></code> configuration dictionary contains general properties of feature
nodes. <code class="docutils literal notranslate"><span class="pre">node_type</span></code> can be <code class="docutils literal notranslate"><span class="pre">one-step</span></code> or <code class="docutils literal notranslate"><span class="pre">multi-step</span></code>, the latter indicating
we have an <code class="docutils literal notranslate"><span class="pre">init</span></code>, a <code class="docutils literal notranslate"><span class="pre">main</span></code> and an <code class="docutils literal notranslate"><span class="pre">end</span></code>. <code class="docutils literal notranslate"><span class="pre">device_related</span></code> is set to
<code class="docutils literal notranslate"><span class="pre">True</span></code> if we have a <code class="docutils literal notranslate"><span class="pre">multi-step</span></code> signal container. <code class="docutils literal notranslate"><span class="pre">need_response</span></code> is set
to true if the signal node waits on hardware (e.g. waits for a stage to confirm
it has indeed moved) before proceeding.</p>
<p>Each of the functions that are the value entries in <code class="docutils literal notranslate"><span class="pre">self.config_table</span></code>
dictionaries are methods of the feature object.</p>
</section>
<section id="creating-custom-feature-object">
<h2>Creating Custom Feature Object<a class="headerlink" href="#creating-custom-feature-object" title="Permalink to this heading"></a></h2>
<p>Each Feature Object is defined as a class, there is a step-by-step example feature
that moves the stage to a specific position listed in the multi-position table in the GUI,
snap an image and calculate its Shannon entropy.</p>
<ol class="arabic simple">
<li><p>How to create a custom feature class?</p></li>
</ol>
<p>Creating a new feature is the same as a normal new class. However, there is some requires.
The first parameter of the <code class="docutils literal notranslate"><span class="pre">__init__</span></code> function must be <code class="docutils literal notranslate"><span class="pre">model</span></code>, which gives the feature
object full access to the model. All the other parameters are keyword arguments and must have default values.
There should always have a config_table attribute (see <a class="reference external" href="../../html/feature_container/feature_container_home.html#the-feature-object">above</a> for a description of the config_table)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">navigate.model.analysis.image_contrast</span> <span class="kn">import</span> <span class="n">fast_normalized_dct_shannon_entropy</span>

<span class="n">Class</span> <span class="n">FeatureExample</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">position_id</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">position_id</span> <span class="o">=</span> <span class="n">position_id</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config_table</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;signal&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;init&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pre_func_signal</span><span class="p">,</span>
                    <span class="s2">&quot;main&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_func_signal</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;main&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_func_data</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="s2">&quot;node&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;device_related&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">}</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>How to get parameters from GUI?</p></li>
</ol>
<p>All the GUI parameters are in the <code class="docutils literal notranslate"><span class="pre">model.configuration[&quot;experiment&quot;]</span></code> during
runtime. Here is an example that get positions from the multi-position table
in the GUI.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pre_func_signal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">configuration</span><span class="p">[</span><span class="s2">&quot;experiment&quot;</span><span class="p">][</span><span class="s2">&quot;MultiPositions&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">position_id</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">positions</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_position</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">position_id</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">current_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">get_stage_position</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_position</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">axis</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">],</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">axis</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">current_position</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
</pre></div>
</div>
<p>More GUI parameters can be found in <a class="reference external" href="https://github.com/TheDeanLab/navigate/blob/develop/src/navigate/config/experiment.yml">experiment.yml</a></p>
<ol class="arabic simple" start="3">
<li><p>How to interact with stage?</p></li>
</ol>
<p>Now, we move stage to the target_position.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">in_func_signal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s2">_abs&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">axis</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_position</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">move_stage</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">wait_until_done</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>How to get an image and deal with it?</p></li>
</ol>
<p>The image captured by the camara will be stored in the data buffer.
You should add your code to deal with the image in the main data function.
Here is an example that calculates the Shannon entropy of the image.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">in_func_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_ids</span><span class="p">):</span>
    <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">frame_ids</span><span class="p">:</span>
        <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">data_buffer</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>
        <span class="n">entropy</span> <span class="o">=</span> <span class="n">fast_normalized_dct_shannon_entropy</span><span class="p">(</span><span class="n">image</span><span class="p">,</span>
            <span class="n">psf_support_diameter_xy</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;entropy of image:&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">entropy</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, you’ve create a whole new feature and can use it as you wish.</p>
<ul class="simple">
<li><p>How to interact with other devices?</p></li>
</ul>
<p>You could interact with all devices through <code class="docutils literal notranslate"><span class="pre">self.model.active_microscope</span></code>.
Here is an example to open shutter:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">active_microscope</span><span class="o">.</span><span class="n">shutter</span><span class="o">.</span><span class="n">open_shutter</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p>How to pause and resume data threads in the model</p></li>
</ul>
<p>The image data acquired from the camara are handled in an indepandant thread.
Some devices need more time to get ready or move. In this case, you may need to pause
the data thread until the device is ready.</p>
<p>Here is an example to pause and resume the data thread:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">pause_data_thread</span><span class="p">()</span>
<span class="c1"># ...</span>
<span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">resume_data_thread</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Frequently used APIs in the model are:</p></li>
</ul>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/TheDeanLab/navigate/blob/develop/src/navigate/config/experiment.yml">configuration[“experiment”]</a> has all the GUI settings</p></li>
<li><p><a class="reference external" href="../../html/_autosummary/navigate.model.model.Model.html#navigate.model.model.Model.pause_data_thread">pause_data_thread()</a></p></li>
<li><p><a class="reference external" href="../../html/_autosummary/navigate.model.model.Model.html#navigate.model.model.Model.resume_data_thread">resume_data_thread()</a></p></li>
</ul>
<ul class="simple">
<li><p>Frequently used APIs in the Microscope are:</p></li>
</ul>
<ul class="simple">
<li><p><a class="reference external" href="../../html/_autosummary/navigate.model.microscope.Microscope.html#navigate.model.microscope.Microscope.prepare_next_channel">prepare_next_channel()</a></p></li>
<li><p><a class="reference external" href="../../html/_autosummary/navigate.model.microscope.Microscope.html#navigate.model.microscope.Microscope.move_stage">move_stage()</a></p></li>
<li><p><a class="reference external" href="../../html/_autosummary/navigate.model.microscope.Microscope.html#navigate.model.microscope.Microscope.get_stage_position">get_stage_position()</a></p></li>
<li><p><a class="reference external" href="../../html/_autosummary/navigate.model.microscope.Microscope.html#navigate.model.microscope.Microscope.update_stage_limits">update_stage_limits()</a></p></li>
<li><p><a class="reference external" href="../../html/_autosummary/navigate.model.microscope.Microscope.html#navigate.model.microscope.Microscope.move_remote_focus">move_remote_focus()</a></p></li>
</ul>
<p>Please visit <a class="reference external" href="../../html/_autosummary/navigate.model.model.Model.html#navigate.model.microscope.Microscope.calculate_all_waveform">Model APIs</a> and <a class="reference external" href="../../html/_autosummary/navigate.model.microscope.Microscope.html">Microscope APIs</a> for more details.</p>
</section>
<section id="creating-a-custom-feature-list">
<h2>Creating A Custom Feature List<a class="headerlink" href="#creating-a-custom-feature-list" title="Permalink to this heading"></a></h2>
<p>The Navigate Software allows you to build a custom feature that implements new
functionality, or a new feature list that builds an intelligent acquisition workflow
from existing features. This documentation explains how to create and load
a customized feature list within the Navigate software. The first step is to create a
Python function, and decorating it as a “FeatureList.” .</p>
<p>To create a customized feature, follow these steps:</p>
<ol class="arabic simple">
<li><p>Import the necessary modules:</p></li>
</ol>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">navigate.tools.decorators</span> <span class="kn">import</span> <span class="n">FeatureList</span>
<span class="kn">from</span> <span class="nn">navigate.model.features.feature_related_functions</span> <span class="kn">import</span> <span class="o">*</span>

<span class="nd">@FeatureList</span>
<span class="k">def</span> <span class="nf">feature_example</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">[</span>
        <span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">PrepareNextChannel</span><span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">LoopByCount</span><span class="p">,</span>
                <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;experiment.MicroscopeState.selected_channels&quot;</span><span class="p">,),</span>
            <span class="p">},</span>
        <span class="p">)</span>
    <span class="p">]</span>
</pre></div>
</div>
<p>Once you’ve created a feature, you can load it into the Navigate software using these steps:</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Open Navigate.</p></li>
<li><p>Go to the <cite>Features</cite> menu.</p></li>
</ol>
<img alt="../_images/step_1.png" src="../_images/step_1.png" />
<p>4a. Import the customized feature. Select <cite>Add Custom Feature List</cite> from the
<cite>Features</cite> menu. A dialog box will appear, allowing you to select the Python file
containing your customized feature list function.</p>
<img alt="../_images/step_2.png" src="../_images/step_2.png" />
<p>5. Choose the Python file containing your customized feature list function. Navigate will
load the specified feature list, making it available for use in your experiments and
analyses. It will appear at the bottom of the <cite>Features</cite> menu.</p>
</section>
<section id="combining-features">
<h2>Combining Features<a class="headerlink" href="#combining-features" title="Permalink to this heading"></a></h2>
<p>Once you have loaded your feature list, the next step is to use it in combination with
other features to create an intelligent acquisition workflow. To do this, you will
need to create a new feature list that combines your custom feature with other
features:</p>
<p>1. Navigate back to the <cite>Features</cite> menu, and select <cite>Add Customized Feature List</cite>.
You could add a new feature list directly in the software, by selecting the menu
“Features-&gt;Add Customized Feature List”. This will open a new dialog box that allows
you to create a new feature list.</p>
<p>2. Provide the feature list with a <cite>Feature List Name</cite> of your choice, and type the
feature list content (which must be a list object). The feature list content could be
the whole feature list or just a simple feature name. In this example, the feature
list name is <cite>Feature Example 2</cite>, and the content is a simple feature name: [{“name”:
PrepareNextChannel}]. Once you select <cite>Preview</cite>, the feature list will be displayed
in the <cite>Preview</cite> window. If you are satisfied with the feature list, select <cite>OK</cite> to
save it.</p>
<img alt="../_images/step_3.png" src="../_images/step_3.png" />
<p>3. You could edit the list of features directly by modifying the text, or through a
popup menu that is available by right clicking the feature name. The popup menu
allows you to add a new feature, delete a feature, or edit a feature. In this
example, click “Insert After”, and a new feature “PrepareNextChannel”
will be inserted by default.</p>
<img alt="../_images/step_4.png" src="../_images/step_4.png" />
<img alt="../_images/step_5.png" src="../_images/step_5.png" />
<p>4. To change the identity of the inserted feature, you can select a different feature
form the drop-down menu. For example, the feature can be changed from
PrepareNextChannel to LoopByCount. The parameters of the feature can be changed
automatically in the popup window.</p>
<img alt="../_images/step_6.png" src="../_images/step_6.png" />
<p>5. If you click the preview button, a graphical representation of the feature list will
be displayed.</p>
<img alt="../_images/step_7.png" src="../_images/step_7.png" />
<p>6. If you want a loop structure, type a pair of parentheses around the features, then
click “Preview”. Given this design, you can loop through arbitrary features in a
user-selected format.</p>
<img alt="How to create a custom feature list." src="../_images/step_8.png" />
<p>7. After editing the feature list, click “Add”. The new feature list will show up
under the “Features” menu.</p>
</section>
<section id="loading-custom-functions">
<h2>Loading Custom Functions<a class="headerlink" href="#loading-custom-functions" title="Permalink to this heading"></a></h2>
<p>1. You could load customized functions in the software by selecting the menu
“Features-&gt;Advanced Setting”.</p>
<img alt="../_images/step_10.png" src="../_images/step_10.png" />
<p>2. In the popup window, choose the feature name with which you want to use the
dynamic customized functions as feature parameters.</p>
<img alt="../_images/step_11.png" src="../_images/step_11.png" />
<img alt="../_images/step_12.png" src="../_images/step_12.png" />
<p>3. Click “Add”, A new line will appear and allow you to edit the parameter options.
Type the function name which is defined in your python file.</p>
<img alt="../_images/step_13.png" src="../_images/step_13.png" />
<ol class="arabic simple" start="4">
<li><p>Then click “Load” to choose your python file.</p></li>
</ol>
<img alt="../_images/step_14.png" src="../_images/step_14.png" />
<p>5. When you run a feature list containing the feature you just set, the new function
name will appear and you can choose the one you just added.</p>
<img alt="../_images/step_15.png" src="../_images/step_15.png" />
</section>
<section id="editing-function-parameters">
<h2>Editing Function Parameters<a class="headerlink" href="#editing-function-parameters" title="Permalink to this heading"></a></h2>
<p>1. Select the feature list you want to run, choose “Customized” acquisition mode, and
then click “Acquire”. A feature edit popup window will show up. In this popup window,
you can see the structure of the selected feature list.</p>
<img alt="../_images/step_16.png" src="../_images/step_16.png" />
<img alt="../_images/step_17.png" src="../_images/step_17.png" />
<img alt="../_images/step_18.png" src="../_images/step_18.png" />
<p>2. Click one feature in the preview window, a parameter window will show up. Then you
could set the parameter you want. Close the parameter window.</p>
<img alt="../_images/step_19.png" src="../_images/step_19.png" />
<ol class="arabic simple" start="3">
<li><p>Click “Confirm”. The feature list will start to run.</p></li>
</ol>
<img alt="../_images/step_20.png" src="../_images/step_20.png" />
</section>
<section id="deleting-features">
<h2>Deleting Features<a class="headerlink" href="#deleting-features" title="Permalink to this heading"></a></h2>
<ol class="arabic simple">
<li><p>Select the feature list you want to delete in the <cite>Features</cite> menu.</p></li>
</ol>
<p>2. Then, navigate back to the <cite>Features</cite> menu and select <cite>Delete Selected Feature</cite>
List”. The feature list will be removed from the menu and the software.</p>
<img alt="../_images/step_9.png" src="../_images/step_9.png" />
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../hardware/contributing_hardware.html" class="btn btn-neutral float-left" title="Adding New Hardware" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../contributing/contributing_guidelines.html" class="btn btn-neutral float-right" title="Contributing Guidelines" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Dean Lab, UT Southwestern Medical Center.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>